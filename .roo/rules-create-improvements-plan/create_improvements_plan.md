# 🧠 実装計画書作成ルール（Roo Code向け）

このドキュメントは、VSCode拡張「Roo Code」でPromptsmithプロジェクトにおける実装計画書を作成するためのルールセットです。実装計画書は設計書を読み解き、実装タスクに分解し、効率的な開発を支援するためのドキュメントです。

---

## ✅ 実装計画書の目的

- 設計書を読み解き、具体的な実装タスクに分解する
- 各タスクの工数、テスト内容、実装方針、完了条件を明確にする
- 開発チームが効率的に作業を進めるためのガイドラインを提供する
- 進捗管理を容易にするためのチェックリストを提供する

---

## 📋 実装計画書の基本構成

```
# [機能名] 実装計画書

## 1. 実装目的
[機能の目的と概要を簡潔に記述]

## 2. 実装スケジュール
[フェーズ、内容、期間、担当者を表形式で記述]

## 3. 実装対象ファイル一覧
[新規作成ファイル、修正対象ファイルを記述]

## 4. 詳細実装計画
[各コンポーネント、機能ごとの詳細な実装計画]

## 5. テスト計画
[単体テスト、統合テスト、E2Eテストの計画]

## 6. デプロイ計画
[デプロイ前チェックリスト、デプロイ手順、ロールバック計画]

## 7. リスク管理
[想定されるリスクと対策]

## 8. 将来の拡張計画
[短期的、中長期的な拡張計画]

## 9. 実装時の注意点
[セキュリティ、パフォーマンス、アクセシビリティなどの注意点]
```

---

## 🔍 実装タスクの分解方法

### タスク分解の原則

1. **粒度の適正化**：

   - 1つのタスクは1人の開発者が1日〜3日程度で完了できる粒度に分解する
   - 大きすぎるタスクは細分化し、小さすぎるタスクは適宜まとめる

2. **依存関係の明確化**：

   - タスク間の依存関係を明確にし、順序付けを行う
   - 並行して進められるタスクを識別する

3. **コンポーネント単位での分解**：

   - UI、ロジック、データアクセス層など、コンポーネント単位でタスクを分解する
   - 各レイヤーの責務を明確にする

4. **チェックリスト形式**：
   - 各タスクはチェックリスト形式で記述し、進捗管理を容易にする
   - 例: `- [ ] ユーザー登録APIのバリデーション機能を実装`

### タスク記述の例

```markdown
### 4.1 ユーザー登録機能の実装

#### 実装タスク

- [ ] ユーザー登録フォームのUIコンポーネントを実装

  - 工数: 1日
  - テスト: コンポーネントのレンダリングテスト、入力検証テスト
  - 実装方針: FormInputコンポーネントを再利用し、TailwindCSSでスタイリング
  - 完了条件: デザイン通りのフォームが表示され、入力検証が正常に動作すること

- [ ] ユーザー登録APIのバリデーション機能を実装

  - 工数: 0.5日
  - テスト: 各バリデーションルールのユニットテスト
  - 実装方針: zodライブラリを使用したバリデーションスキーマの定義
  - 完了条件: すべてのバリデーションルールが正しく機能すること

- [ ] ユーザー登録APIのDBへのInsert機能を実装
  - 工数: 1日
  - テスト: DBへの挿入テスト、エラーハンドリングテスト
  - 実装方針: Supabase Clientを使用したデータ挿入、トランザクション管理
  - 完了条件: ユーザーデータが正しくDBに保存され、重複エラーなどが適切に処理されること
```

---

## 📊 工数見積もりのガイドライン

### 工数の単位

- 基本単位は「人日」（1人が1日かかる作業量）
- 0.5日（半日）、1日、2日、3日などの単位で記述
- 3日を超える場合は、さらに細かいタスクに分解することを検討

### 工数見積もりの考慮点

- 開発者のスキルレベル（平均的なスキルを想定）
- 類似機能の過去の開発実績
- 技術的な難易度
- テスト工数も含める
- バッファ（予期せぬ問題への対応時間）を考慮

---

## 🧪 テスト内容の記述方法

### テスト種別

- **単体テスト**：個々の関数、メソッド、コンポーネントのテスト
- **統合テスト**：複数のコンポーネントが連携する機能のテスト
- **E2Eテスト**：ユーザーの操作シナリオに基づくテスト

### テスト内容の記述例

```markdown
#### テスト計画

- 単体テスト

  - 入力バリデーション関数のテスト
  - APIリクエスト処理関数のテスト
  - UIコンポーネントのレンダリングテスト

- 統合テスト

  - フォーム送信からAPI呼び出しまでの一連の流れのテスト
  - エラー発生時のフィードバック表示テスト

- E2Eテスト
  - ユーザーがフォームに入力し送信するシナリオ
  - 入力エラー時の挙動確認シナリオ
```

---

## 📝 実装方針の記述方法

### 実装方針に含めるべき情報

- 使用する技術、ライブラリ、フレームワーク
- アーキテクチャ上の決定事項
- パフォーマンス、セキュリティに関する考慮事項
- 既存コードとの統合方法
- コーディング規約や命名規則

### 実装方針の記述例

```markdown
#### 実装方針

- Composable APIを活用した状態管理

  - `useUserRegistration.ts` コンポーザブルでフォーム状態とバリデーションを管理
  - `useSupabaseClient` を使用したDB操作

- エラーハンドリング

  - try-catch構文でのエラーキャッチ
  - エラータイプに応じたユーザーフレンドリーなメッセージ表示

- セキュリティ対策
  - クライアントサイドとサーバーサイド両方でのバリデーション
  - RLSポリシーによるデータアクセス制御
```

---

## ✅ 完了条件の記述方法

### 完了条件の設定原則

- 明確で測定可能な条件を設定する
- 機能要件と非機能要件の両方を考慮する
- テスト結果や品質指標と紐づける
- ユーザー体験の観点も含める

### 完了条件の記述例

```markdown
#### 完了条件

- 機能面

  - ユーザーがフォームに入力し送信すると、データがDBに正しく保存される
  - バリデーションエラーが発生した場合、適切なエラーメッセージが表示される
  - 処理成功時に成功メッセージが表示され、指定ページにリダイレクトされる

- 非機能面
  - フォーム送信からレスポンス表示までの時間が2秒以内
  - すべての単体テストと統合テストがパスする
  - コードレビューでの指摘事項が解消されている
```

---

## 📈 進捗管理の方法

### 進捗状況の記録

- 各タスクの前に `- [ ]` （未完了）または `- [x]` （完了）のチェックボックスを付ける
- 部分的に完了している場合は、詳細な進捗状況をコメントで記録する
- 予定工数と実績工数の差異を記録し、今後の見積もり精度向上に活用する

### 進捗報告の例

```markdown
#### 進捗状況（2025/6/8更新）

- [x] ユーザー登録フォームのUIコンポーネントを実装

  - 完了日: 2025/6/5
  - 予定工数: 1日、実績工数: 1.5日
  - 備考: モバイル対応に追加時間が必要だった

- [ ] ユーザー登録APIのバリデーション機能を実装

  - 進捗率: 50%
  - 残作業: カスタムバリデーションルールの実装

- [ ] ユーザー登録APIのDBへのInsert機能を実装
```

---

## 📚 参考資料

- [Nuxt 3公式ドキュメント](https://nuxt.com/docs)
- [Supabase公式ドキュメント](https://supabase.io/docs)
- [TailwindCSS公式ドキュメント](https://tailwindcss.com/docs)
- プロジェクト内の既存実装計画書
  - `docs/improvements/openai_api_settings_implementation_plan.md`
  - `docs/improvements/prompt_create_improvements.md`

---

以上のルールに従って実装計画書を作成してください。実装計画書は開発チームの共通理解を促進し、効率的な開発を支援するための重要なドキュメントです。
